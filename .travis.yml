# References: https://www.cloudways.com/blog/php-continuous-integration-travis-ci/
# References: https://docs.travis-ci.com/user/notifications/
# References: https://gist.github.com/gilbitron/5cac0ac5fa07e9b354ac
# References: https://docs.travis-ci.com/user/sonarcloud/

dist: trusty

language: php

cache: bundler

php:
- 7.2.10

before_script:
  - cp .env.travis .env
  - composer self-update
  - composer install --no-interaction
  - npm install

addons:
  sonarcloud:
    organization: dejongyeong-github
    token:
      secure: "MFTj8c6fheT7q1ePQ3XyGpTh//VOWmMgFKI5oaWqGssPt9RcIxpXPyYkVew2jEcE4w6+hV5Mk95uQ6cZpQRVgPIsbvMCcnUku/KnoZK53w7SltlJAWhQ6hzsYE2PdRoCXZiAHh+1bQA22/wh2+S+QmpQJ/InmrTFBEwZAvIZs6ascLYi024y1OnX7ZpNTJhfcPRfEW4Rp/jK4L+44VqLSv0yXngNYY+5M48vv7NRedGNs64JZeGdPtj4BYlW6wyCl8w1hzHqbbeK+5oRbtp1KSXAAwBGkdFpdGRoSTWvJart8q3txdBNKCmuTW4/8i6zvzEx6YO2k0WvyYBPHTMvsAvXPf+S0KoHewK0TWtqcyMlUelQ7fa5PWa6JlSsPSrJjbKY6il4ok1UZIIf8KYhmFJKTL7Iiu1+hlYasxTW/F9E/oXgGcQBahE6T9lexHfx8UtXNNb+m5c962zDJK5Fw8YQ5G1j/olTIQGOIbs1N/5D50MIP3PSGyZ6EHVEQ7MVKbhnSKYzEJfwdxBurKmNwGjakFWIGxOa1HREIgNuExLERdx+oE6i0aOojda0pg1nUvGQ4nwxmIq/UguNlLIUSJMFSI5WmXEt6iSlYGQhdI9Xup0ZYdc//u6T4yBfs9aXN2anvusZNR+vYeZbftdDpXgzJmyf2H9HNHtIGfc29zA="

script:
  - php artisan key:generate
  - php artisan passport:install
  - php artisan migrate
  - vendor/bin/phpunit
  - sonar-scanner

deploy:
  provider: heroku
  api_key:
    secure: "WFlBUfRjUjC3z/UXVj5z7iQB8xLVnvZzDGbdSFzxxANVnkr5zeROAVrMxXbj3djp7+OlQtujCLsPV9paA7Ki4oXEcUeUPrSeQZTBi46mlMt5856FQ8TDw8b1zfYuo5u3fTx7uBaiq++EUy9CqL862A1k29d4anpZUQMfQrpjKLSQCPWPPiB4Cr8EQfHALc6ZqN26GGO6dRk2mSA08NuEcP66iCS2Xdfd88qgcANVc4zDJhgjnbdMnisVrDpYVErjodsjgSxxf7txMfeD18X6vRT8BCdipJBsdi4x/xIpuC3NcFGCi7QG3hLsDZ3K4gesuBdjvfYx9qZEX+OFzfUG+/QFn7osITWNeH4DIkVPpfednmBoUpyZAsGNlGXlzlW2AWwC4rA3iGWuSPU07SLeKApxlHD54pMFSaXXsB6+kRDXRkzYZoFlX6IpG4DMPV3xtioMToVlaEROJ8Uwn7mIsW7xS/5VXVj1XZ/lRo4VRQ8L9UF+dBXJIqKjmiDBJu6q2+QqLfhO4zb8DceiN48GPgDFZ1guTq5tHR8rLtK8lOf+0J7na9DZV1/ywkAMMVYH+dodi82ygVfQgcV73F8HpfMqQUFBIMUCSocvxJaTUl7gXtAcVhwXC76a9XguRVyMwlZGFmFDKNjGI5XQpnrYqfQhQzRPz4YYcM9cbRwdLWQ="
  on:
    master

matrix:
  fast_finish: true

notifications:
  slack: ittralee:aGvG53DwjXzULD6B07n9Xe8o
  on_success: always
  on_failure: always
